package partition

import (
	"errors"
	"fmt"
)

var Partitions = []string{
	"archive",
	"June_2019",
	"July_2019",
	"August_2019",
	"September_2019",
	"October_2019",
	"November_2019",
	"December_2019",
	"January_2020",
	"February_2020",
	"March_2020",
	"April_2020",
	"May_2020",
	"June_2020",
	"July_2020",
	"August_2020",
	"September_2020",
	"October_2020",
	"November_2020",
	"December_2020",
	"January_2021",
	"February_2021",
	"March_2021",
	"April_2021",
	"May_2021",
	"June_2021",
	"July_2021",
	"August_2021",
	"September_2021",
	"October_2021",
	"November_2021",
	"December_2021",
	"January_2022",
	"February_2022",
	"March_2022",
	"April_2022",
	"May_2022",
	"June_2022",
	"July_2022",
	"August_2022",
	"September_2022",
	"October_2022",
	"November_2022",
	"December_2022",
	"January_2023",
	"February_2023",
	"March_2023",
	"April_2023",
	"May_2023",
	"June_2023",
	"July_2023",
	"August_2023",
	"September_2023",
	"October_2023",
	"November_2023",
	"December_2023",
	"January_2024",
	"February_2024",
	"March_2024",
	"April_2024",
	"May_2024",
	"June_2024",
	"July_2024",
	"August_2024",
	"September_2024",
	"October_2024",
	"November_2024",
	"December_2024",
	"January_2025",
	"February_2025",
	"March_2025",
	"April_2025",
	"May_2025",
	"June_2025",
	"July_2025",
	"August_2025",
	"September_2025",
	"October_2025",
	"November_2025",
	"December_2025",
	"January_2026",
	"February_2026",
	"March_2026",
	"April_2026",
	"May_2026",
	"June_2026",
	"July_2026",
	"August_2026",
	"September_2026",
	"October_2026",
	"November_2026",
	"December_2026",
	"January_2027",
	"February_2027",
	"March_2027",
	"April_2027",
	"May_2027",
	"June_2027",
	"July_2027",
	"August_2027",
	"September_2027",
	"October_2027",
	"November_2027",
	"December_2027",
	"January_2028",
	"February_2028",
	"March_2028",
	"April_2028",
	"May_2028",
	"June_2028",
	"July_2028",
	"August_2028",
	"September_2028",
	"October_2028",
	"November_2028",
	"December_2028",
	"January_2029",
	"February_2029",
	"March_2029",
	"April_2029",
	"May_2029",
	"June_2029",
	"July_2029",
	"August_2029",
	"September_2029",
	"October_2029",
	"November_2029",
	"December_2029",
	"January_2030",
	"February_2030",
	"March_2030",
	"April_2030",
	"May_2030",
	"June_2030",
	"July_2030",
	"August_2030",
	"September_2030",
	"October_2030",
	"November_2030",
	"December_2030",
	"January_2031",
	"February_2031",
	"March_2031",
	"April_2031",
	"May_2031",
	"June_2031",
	"July_2031",
	"August_2031",
	"September_2031",
	"October_2031",
	"November_2031",
	"December_2031",
	"January_2032",
	"February_2032",
	"March_2032",
	"April_2032",
	"May_2032",
	"June_2032",
	"July_2032",
	"August_2032",
	"September_2032",
	"October_2032",
	"November_2032",
	"December_2032",
	"January_2033",
	"February_2033",
	"March_2033",
	"April_2033",
	"May_2033",
	"June_2033",
	"July_2033",
	"August_2033",
	"September_2033",
	"October_2033",
	"November_2033",
	"December_2033",
	"January_2034",
	"February_2034",
	"March_2034",
	"April_2034",
	"May_2034",
	"June_2034",
	"July_2034",
	"August_2034",
	"September_2034",
	"October_2034",
	"November_2034",
	"December_2034",
	"January_2035",
	"February_2035",
	"March_2035",
	"April_2035",
	"May_2035",
	"June_2035",
	"July_2035",
	"August_2035",
	"September_2035",
	"October_2035",
	"November_2035",
	"December_2035",
	"January_2036",
	"February_2036",
	"March_2036",
	"April_2036",
	"May_2036",
	"June_2036",
	"July_2036",
	"August_2036",
	"September_2036",
	"October_2036",
	"November_2036",
	"December_2036",
	"January_2037",
	"February_2037",
	"March_2037",
	"April_2037",
	"May_2037",
	"June_2037",
	"July_2037",
	"August_2037",
	"September_2037",
	"October_2037",
	"November_2037",
	"December_2037",
	"January_2038",
	"February_2038",
	"March_2038",
	"April_2038",
	"May_2038",
	"June_2038",
	"July_2038",
	"August_2038",
	"September_2038",
	"October_2038",
	"November_2038",
	"December_2038",
	"January_2039",
	"February_2039",
	"March_2039",
	"April_2039",
	"May_2039",
	"June_2039",
	"July_2039",
	"August_2039",
	"September_2039",
	"October_2039",
	"November_2039",
	"December_2039",
	"January_2040",
	"February_2040",
	"March_2040",
	"April_2040",
	"May_2040",
	"future",
}

func Gen(startIdx, count int) (string, error) {
	partitionString := "PARTITION ( "

	if startIdx >= len(Partitions) {
		fmt.Printf("startIdx less than partitions count")
		err := errors.New("no more partitions left")
		return "", err
	}

	endIdx := startIdx + count
	if len(Partitions) <= endIdx {
		endIdx = len(Partitions)
	}

	partitions := Partitions[startIdx:endIdx]
	for idx, partition := range partitions {
		if partition == "January_2023" || partition == "February_2023" || partition == "March_2023" {
			continue
		}

		if idx != len(partitions) && partitionString != "PARTITION ( " {
			partitionString += ", "
		}

		partitionString += partition
	}
	partitionString += " )"
	return partitionString, nil
}
